<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wasm experiments</title>
</head>
<body>
<div id="log" class="log"></div>
<pre style="color:#000020;background:#f6f8ff;">

    <span style="color:#200080; font-weight:bold; ">const</span> w <span style="color:#308080; ">=</span> await wasm<span style="color:#308080; ">(</span>wasm_url<span style="color:#308080; ">,</span> importObj<span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>

    logger<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">log</span><span style="color:#308080; ">(</span>arr<span style="color:#308080; ">,</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Маccив</span><span style="color:#800000; ">'</span><span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>
    logger<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">log</span><span style="color:#308080; ">(</span>w<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">call</span><span style="color:#308080; ">(</span><span style="color:#800000; ">'</span><span style="color:#1060b6; ">_sum</span><span style="color:#800000; ">'</span><span style="color:#308080; ">,</span> <span style="color:#308080; ">[</span><span style="color:#406080; ">{</span>array<span style="color:#406080; ">:</span> arr<span style="color:#308080; ">,</span> type<span style="color:#406080; ">:</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Int32</span><span style="color:#800000; ">'</span><span style="color:#406080; ">}</span><span style="color:#308080; ">,</span> arr<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">length</span><span style="color:#308080; ">]</span><span style="color:#308080; ">)</span><span style="color:#308080; ">,</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Сумма его элементов</span><span style="color:#800000; ">'</span><span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>

    <span style="color:#200080; font-weight:bold; ">let</span> new_arr <span style="color:#308080; ">=</span> w<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">call</span><span style="color:#308080; ">(</span><span style="color:#800000; ">'</span><span style="color:#1060b6; ">_duplicate_arr</span><span style="color:#800000; ">'</span><span style="color:#308080; ">,</span>
        <span style="color:#308080; ">[</span><span style="color:#406080; ">{</span>array<span style="color:#406080; ">:</span> arr<span style="color:#308080; ">,</span> type<span style="color:#406080; ">:</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Int32</span><span style="color:#800000; ">'</span><span style="color:#406080; ">}</span><span style="color:#308080; ">,</span> arr<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">length</span><span style="color:#308080; ">]</span><span style="color:#308080; ">,</span>
        <span style="color:#406080; ">{</span>type<span style="color:#406080; ">:</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">int32</span><span style="color:#800000; ">'</span><span style="color:#308080; ">,</span> <span style="color:#200080; font-weight:bold; ">length</span><span style="color:#406080; ">:</span> arr<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">length</span> <span style="color:#308080; ">*</span> <span style="color:#008c00; ">2</span><span style="color:#308080; ">,</span> to_array<span style="color:#406080; ">:</span> <span style="color:#0f4d75; ">true</span><span style="color:#406080; ">}</span><span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>
    logger<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">log</span><span style="color:#308080; ">(</span>new_arr<span style="color:#308080; ">,</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Новый массив возвращенный из C++ функции</span><span style="color:#800000; ">'</span><span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>
    logger<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">log</span><span style="color:#308080; ">(</span>w<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">call</span><span style="color:#308080; ">(</span><span style="color:#800000; ">'</span><span style="color:#1060b6; ">_sum</span><span style="color:#800000; ">'</span><span style="color:#308080; ">,</span> <span style="color:#308080; ">[</span><span style="color:#406080; ">{</span>array<span style="color:#406080; ">:</span> new_arr<span style="color:#308080; ">,</span> type<span style="color:#406080; ">:</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Int32</span><span style="color:#800000; ">'</span><span style="color:#406080; ">}</span><span style="color:#308080; ">,</span> new_arr<span style="color:#308080; ">.</span><span style="color:#200080; font-weight:bold; ">length</span><span style="color:#308080; ">]</span><span style="color:#308080; ">)</span><span style="color:#308080; ">,</span> <span style="color:#800000; ">'</span><span style="color:#1060b6; ">Сумма его элементов</span><span style="color:#800000; ">'</span><span style="color:#308080; ">)</span><span style="color:#406080; ">;</span>

</pre>
<script id="wasm" src="test.c526cdb9.wasm" type="application/wasm"></script>
<script src="src.e31bb0bc.js"></script>
</body>
</html>